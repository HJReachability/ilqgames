\hypertarget{classilqgames_1_1_semiquadratic_polyline2_cost}{}\section{ilqgames\+:\+:Semiquadratic\+Polyline2\+Cost Class Reference}
\label{classilqgames_1_1_semiquadratic_polyline2_cost}\index{ilqgames\+::\+Semiquadratic\+Polyline2\+Cost@{ilqgames\+::\+Semiquadratic\+Polyline2\+Cost}}
Inheritance diagram for ilqgames\+:\+:Semiquadratic\+Polyline2\+Cost\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classilqgames_1_1_semiquadratic_polyline2_cost}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bfseries Semiquadratic\+Polyline2\+Cost} (float weight, const \hyperlink{classilqgames_1_1_polyline2}{Polyline2} \&polyline, const std\+::pair$<$ Dimension, Dimension $>$ \&position\+\_\+idxs, float threshold, bool oriented\+\_\+right, const std\+::string \&name=\char`\"{}\char`\"{})\hypertarget{classilqgames_1_1_semiquadratic_polyline2_cost_a7e928410aef0e930024890fb519b1290}{}\label{classilqgames_1_1_semiquadratic_polyline2_cost_a7e928410aef0e930024890fb519b1290}

\item 
float {\bfseries Evaluate} (const Vector\+Xf \&input) const \hypertarget{classilqgames_1_1_semiquadratic_polyline2_cost_abe1063a923c02e53e3512b4de85539b8}{}\label{classilqgames_1_1_semiquadratic_polyline2_cost_abe1063a923c02e53e3512b4de85539b8}

\item 
void \hyperlink{classilqgames_1_1_semiquadratic_polyline2_cost_aa50a16b3417909909e0793708090ac89}{Quadraticize} (const Vector\+Xf \&input, Matrix\+Xf $\ast$hess, Vector\+Xf $\ast$grad=nullptr) const 
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 55 of file semiquadratic\+\_\+polyline2\+\_\+cost.\+h.



\subsection{Member Function Documentation}
\index{ilqgames\+::\+Semiquadratic\+Polyline2\+Cost@{ilqgames\+::\+Semiquadratic\+Polyline2\+Cost}!Quadraticize@{Quadraticize}}
\index{Quadraticize@{Quadraticize}!ilqgames\+::\+Semiquadratic\+Polyline2\+Cost@{ilqgames\+::\+Semiquadratic\+Polyline2\+Cost}}
\subsubsection[{\texorpdfstring{Quadraticize(const Vector\+Xf \&input, Matrix\+Xf $\ast$hess, Vector\+Xf $\ast$grad=nullptr) const }{Quadraticize(const VectorXf &input, MatrixXf *hess, VectorXf *grad=nullptr) const }}]{\setlength{\rightskip}{0pt plus 5cm}void ilqgames\+::\+Semiquadratic\+Polyline2\+Cost\+::\+Quadraticize (
\begin{DoxyParamCaption}
\item[{const Vector\+Xf \&}]{input, }
\item[{Matrix\+Xf $\ast$}]{hess, }
\item[{Vector\+Xf $\ast$}]{grad = {\ttfamily nullptr}}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classilqgames_1_1_semiquadratic_polyline2_cost_aa50a16b3417909909e0793708090ac89}{}\label{classilqgames_1_1_semiquadratic_polyline2_cost_aa50a16b3417909909e0793708090ac89}
Check if cost is active. 

Implements \hyperlink{classilqgames_1_1_time_invariant_cost}{ilqgames\+::\+Time\+Invariant\+Cost}.



Definition at line 71 of file semiquadratic\+\_\+polyline2\+\_\+cost.\+cpp.


\begin{DoxyCode}
73                                                                     \{
74   CHECK\_LT(xidx\_, input.size());
75   CHECK\_LT(yidx\_, input.size());
76 
77   CHECK\_NOTNULL(hess);
78   CHECK\_EQ(input.size(), hess->rows());
79   CHECK\_EQ(input.size(), hess->cols());
80 
81   \textcolor{keywordflow}{if} (grad) CHECK\_EQ(input.size(), grad->size());
82 
83   \textcolor{comment}{// Unpack current position and find closest point / segment.}
84   \textcolor{keyword}{const} Point2 current\_position(input(xidx\_), input(yidx\_));
85 
86   \textcolor{keywordtype}{float} signed\_squared\_distance;
87   \textcolor{keywordtype}{bool} is\_vertex;
88   LineSegment2 segment(Point2(0.0, 0.0), Point2(1.0, 1.0));
89   \textcolor{keyword}{const} Point2 closest\_point = polyline\_.ClosestPoint(
90       current\_position, &is\_vertex, &segment, &signed\_squared\_distance);
91 \textcolor{comment}{}
92 \textcolor{comment}{  /// Check if cost is active.}
93 \textcolor{comment}{}  \textcolor{keywordflow}{if} (!IsActive(signed\_squared\_distance)) \textcolor{keywordflow}{return};
94 
95   \textcolor{comment}{// Handle cases separately depending on whether or not closest point is}
96   \textcolor{comment}{// a vertex of the polyline.}
97   \textcolor{keywordflow}{if} (!is\_vertex) \{
98     \textcolor{keyword}{const} Point2 relative = current\_position - segment.FirstPoint();
99     \textcolor{keyword}{const} Point2& unit\_segment = segment.UnitDirection();
100 
101     \textcolor{comment}{// Handle Hessian first.}
102     (*hess)(xidx\_, xidx\_) += weight\_ * unit\_segment.y() * unit\_segment.y();
103     (*hess)(yidx\_, yidx\_) += weight\_ * unit\_segment.x() * unit\_segment.x();
104 
105     \textcolor{keyword}{const} \textcolor{keywordtype}{float} cross\_term = weight\_ * unit\_segment.x() * unit\_segment.y();
106     (*hess)(xidx\_, yidx\_) -= cross\_term;
107     (*hess)(yidx\_, xidx\_) -= cross\_term;
108 
109     \textcolor{comment}{// Maybe handle gradient.}
110     \textcolor{keywordflow}{if} (grad) \{
111       \textcolor{keyword}{const} \textcolor{keywordtype}{float} w\_cross =
112           weight\_ * (relative.x() * unit\_segment.y() -
113                      relative.y() * unit\_segment.x() - threshold\_);
114 
115       (*grad)(xidx\_) += w\_cross * unit\_segment.y();
116       (*grad)(yidx\_) -= w\_cross * unit\_segment.x();
117     \}
118   \} \textcolor{keywordflow}{else} \{
119     \textcolor{comment}{// Closest point is a vertex.}
120     (*hess)(xidx\_, xidx\_) += weight\_;
121     (*hess)(yidx\_, yidx\_) += weight\_;
122 
123     \textcolor{keywordflow}{if} (grad) \{
124       \textcolor{keywordtype}{float} scaling = std::sqrt(std::abs(signed\_squared\_distance));
125       scaling = (scaling - std::abs(threshold\_)) / scaling;
126       (*grad)(xidx\_) +=
127           weight\_ * scaling * (current\_position.x() - closest\_point.x());
128       (*grad)(yidx\_) +=
129           weight\_ * scaling * (current\_position.y() - closest\_point.y());
130     \}
131   \}
132 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/travis/build/\+H\+J\+Reachability/ilqgames/include/ilqgames/cost/semiquadratic\+\_\+polyline2\+\_\+cost.\+h\item 
/home/travis/build/\+H\+J\+Reachability/ilqgames/src/semiquadratic\+\_\+polyline2\+\_\+cost.\+cpp\end{DoxyCompactItemize}
